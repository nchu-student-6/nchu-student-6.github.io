---
layout:     post
title:      çº¿ç¨‹æ± å®æˆ˜
subtitle:  ä½¿ç”¨çº¿ç¨‹æ± å¼‚æ­¥å¤„ç†ä»»åŠ¡ï¼Œå¯ä»¥ä¼˜åŒ–æ¥å£å“åº”æ—¶é—´ã€‚
date:       2024-09-02
author:     Zheng Yang
header-img: img/post-bg-article.jpg
catalog: true
tags:
    - çº¿ç¨‹æ± 
---
# é€šè¿‡çº¿ç¨‹æ± å’Œå»¶æ—¶é˜Ÿåˆ—ä¼˜åŒ–æ¥å£å“åº”æ—¶é—´

## ä¸šåŠ¡èƒŒæ™¯

åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘é€šè¿‡ EasyExcel è§£æç™¾ä¸‡æ•°æ®é‡çš„ Excel è¡Œæ•°ï¼Œé¿å…äº† JVM å†…å­˜å ç”¨è¿‡å¤šé—®é¢˜ã€‚ä½†æ˜¯æœ«äº†è¿˜æœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œé‚£å°±æ˜¯**æ¥å£å“åº”å¤ªæ…¢ï¼Œç™¾ä¸‡æ•°æ®é‡éœ€è¦è§£æ 5 ç§’**ï¼Œä½†æ˜¯èƒ½ä¼˜åŒ–è¿˜æ˜¯è¦ä¼˜åŒ–ã€‚åœ¨è¿™èŠ‚è¯¾æˆ‘ä»¬é€šè¿‡çº¿ç¨‹æ± å’Œ Redis å»¶è¿Ÿé˜Ÿåˆ—çš„å½¢å¼ä¼˜åŒ–æ¥å£å“åº”æ—¶é—´ã€‚

[![image-20240823203003150.png](https://i.postimg.cc/WpZQpTtm/image-20240823203003150.png)](https://postimg.cc/G9cMq0F9)
## çº¿ç¨‹æ± å¼‚æ­¥è§£æ Excel è¡Œæ•°

### 1. åˆ›å»ºçº¿ç¨‹æ± 

åˆ›å»ºä¸€ä¸ªå…¬å…±çº¿ç¨‹æ± ï¼Œå› ä¸ºå’±ä»¬è¿™ä¸ªé€»è¾‘æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥ç›´æ¥å®šä¹‰å³å¯ã€‚

```Java
@Service
@RequiredArgsConstructor
public class CouponTaskServiceImpl extends ServiceImpl<CouponTaskMapper, CouponTaskDO> implements CouponTaskService {

    private final ExecutorService executorService = new ThreadPoolExecutor(
            Runtime.getRuntime().availableProcessors(),
            Runtime.getRuntime().availableProcessors() << 1,
            60,
            TimeUnit.SECONDS,
            new SynchronousQueue<>(),
            new ThreadPoolExecutor.DiscardPolicy()
    );
  
    // ......
}
```

çº¿ç¨‹æ± å¤„ç†é€»è¾‘å¦‚ä¸‹


[![1718263071002-c2c40c59-1389-4199-9555-c62837fecead.png](https://i.postimg.cc/t4qfz6kD/1718263071002-c2c40c59-1389-4199-9555-c62837fecead.png)](https://postimg.cc/Cz2mhzWf)

### 2. çº¿ç¨‹æ± å‚æ•°è§£æ

è§£æä¸‹æˆ‘ä»¬çº¿ç¨‹æ± ä¸­çš„å‚æ•°ä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾ç½®ï¼š

- **corePoolSize**ï¼šå› ä¸ºå±äºåç®¡ä»»åŠ¡ï¼Œå¤§æ¦‚ç‡ä¸ä¼šå¾ˆé¢‘ç¹ï¼Œæ‰€ä»¥ç›´æ¥å–æœåŠ¡å™¨ CPU æ ¸æ•°ã€‚
- **maximumPoolSize**ï¼šè¿è¡Œä»»åŠ¡å±äº IO å¯†é›†å‹ï¼Œæœ€å¤§çº¿ç¨‹æ•°ç›´æ¥æœåŠ¡å™¨ CPU æ ¸æ•° 2 å€ã€‚
- **workQueue**ï¼šç†è®ºä¸Šè¯´æˆ‘ä»¬ä¸ä¼šæœ‰é˜»å¡çš„æƒ…å†µï¼Œå› ä¸ºè®¾ç½®çš„çº¿ç¨‹æ•°ä¸å°‘ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸å­˜å‚¨ä»»åŠ¡çš„åŒæ­¥é˜Ÿåˆ—ã€‚
- **handler**ï¼šå¦‚æœçº¿ç¨‹æ•°éƒ½åœ¨è¿è¡Œï¼Œç›´æ¥å°†ä»»åŠ¡ä¸¢å¼ƒå³å¯ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æœ‰å»¶æ—¶é˜Ÿåˆ—å…œåº•ã€‚

### 3. ä½¿ç”¨çº¿ç¨‹æ± å¼‚æ­¥å¤„ç†

å› ä¸ºçº¿ç¨‹æ± å’Œå»¶æ—¶é˜Ÿåˆ—éƒ½å¯èƒ½ä¼šç”¨åˆ° Excel è§£æçš„ä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™ä¸€å—é€»è¾‘æŠ½è±¡å‡ºæ¥ä¸€ä¸ªæ–¹æ³•ã€‚å› ä¸ºç”¨åˆ°äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸ºäº†é¿å…å¤æ‚ï¼Œç›´æ¥ä½¿ç”¨ JSONObject å³å¯ã€‚

```java
private void refreshCouponTaskSendNum(JSONObject delayJsonObject) {
    // é€šè¿‡ EasyExcel ç›‘å¬å™¨è·å– Excel ä¸­æ‰€æœ‰è¡Œæ•°
    RowCountListener listener = new RowCountListener();
    EasyExcel.read(delayJsonObject.getString("fileAddress"), listener).sheet().doRead();
    int totalRows = listener.getRowCount();

    // åˆ·æ–°ä¼˜æƒ åˆ¸æ¨é€è®°å½•ä¸­å‘é€è¡Œæ•°
    CouponTaskDO updateCouponTaskDO = CouponTaskDO.builder()
            .id(delayJsonObject.getLong("couponTaskId"))
            .sendNum(totalRows)
            .build();
    couponTaskMapper.updateById(updateCouponTaskDO);
}
```

ä½¿ç”¨çº¿ç¨‹æ± å¼‚æ­¥è§£æç”¨æˆ·ä¸Šä¼ çš„ Excel æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
@Service
@RequiredArgsConstructor
public class CouponTaskServiceImpl extends ServiceImpl<CouponTaskMapper, CouponTaskDO> implements CouponTaskService {

    private final ExecutorService executorService = new ThreadPoolExecutor(
            Runtime.getRuntime().availableProcessors(),
            Runtime.getRuntime().availableProcessors() << 1,
            60,
            TimeUnit.SECONDS,
            new SynchronousQueue<>(),
            new ThreadPoolExecutor.DiscardPolicy()
    );
  
    @Transactional(rollbackFor = Exception.class)
    @Override
    public void createCouponTask(CouponTaskCreateReqDTO requestParam) {
        // éªŒè¯éç©ºå‚æ•°
        // éªŒè¯å‚æ•°æ˜¯å¦æ­£ç¡®ï¼Œæ¯”å¦‚æ–‡ä»¶åœ°å€æ˜¯å¦ä¸ºæˆ‘ä»¬æœŸæœ›çš„æ ¼å¼ç­‰
        // éªŒè¯å‚æ•°ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚é€‰æ‹©å®šæ—¶å‘é€ï¼Œå‘é€æ—¶é—´æ˜¯å¦ä¸ä¸ºç©ºç­‰
        CouponTemplateQueryRespDTO couponTemplate = couponTemplateService.findCouponTemplateById(requestParam.getCouponTemplateId());
        if (couponTemplate == null) {
            throw new ClientException("ä¼˜æƒ åˆ¸æ¨¡æ¿ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥æäº¤ä¿¡æ¯æ˜¯å¦æ­£ç¡®");
        }
        // ......

        // æ„å»ºä¼˜æƒ åˆ¸æ¨é€ä»»åŠ¡æ•°æ®åº“æŒä¹…å±‚å®ä½“
        CouponTaskDO couponTaskDO = BeanUtil.copyProperties(requestParam, CouponTaskDO.class);
        couponTaskDO.setBatchId(IdUtil.getSnowflakeNextId());
        couponTaskDO.setOperatorId(Long.parseLong(UserContext.getUserId()));
        couponTaskDO.setShopNumber(UserContext.getShopNumber());
        couponTaskDO.setStatus(
                Objects.equals(requestParam.getSendType(), CouponTaskSendTypeEnum.IMMEDIATE.getType())
                        ? CouponTaskStatusEnum.IN_PROGRESS.getStatus()
                        : CouponTaskStatusEnum.PENDING.getStatus()
        );

        // ä¿å­˜ä¼˜æƒ åˆ¸æ¨é€ä»»åŠ¡è®°å½•åˆ°æ•°æ®åº“
        couponTaskMapper.insert(couponTaskDO);

        // ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿè®¡è¡Œæ•°ï¼Ÿå› ä¸ºå‘é€åéœ€è¦æ¯”å¯¹æ‰€æœ‰ä¼˜æƒ åˆ¸æ˜¯å¦éƒ½å·²å‘æ”¾åˆ°ç”¨æˆ·è´¦å·
        // 100 ä¸‡æ•°æ®å¤§æ¦‚éœ€è¦ 4 ç§’æ‰èƒ½è¿”å›å‰ç«¯ï¼Œå¦‚æœåŠ ä¸ŠéªŒè¯å°†ä¼šæ—¶é—´æ›´é•¿ï¼Œæ‰€ä»¥è¿™é‡Œå°†æœ€è€—æ—¶çš„ç»Ÿè®¡æ“ä½œå¼‚æ­¥åŒ–
        JSONObject delayJsonObject = JSONObject
                .of("fileAddress", requestParam.getFileAddress(), "couponTaskId", couponTaskDO.getId());
        executorService.execute(() -> refreshCouponTaskSendNum(delayJsonObject));
    }
}
```



ä¸ç®¡ä½¿ç”¨çº¿ç¨‹æ± æ‰§è¡Œä»€ä¹ˆç±»å‹çš„ä»»åŠ¡ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªé€šç”¨çš„è‡´å‘½é—®é¢˜ï¼Œé‚£å°±æ˜¯**åˆšæŠ•é€’åˆ°çº¿ç¨‹æ± ï¼Œè¿˜æ²¡æœ‰è¿è¡Œå®Œï¼Œåº”ç”¨å®•æœºäº†æ€ä¹ˆæ•´ï¼Ÿ**

æ‰€ä»¥å°±éœ€è¦æˆ‘ä»¬æ¥ä¸‹æ¥è®²åˆ°çš„å»¶æ—¶é˜Ÿåˆ—å…œåº•ï¼Œé¿å…è¿™ç§å®•æœºè¡Œä¸ºã€‚

## Redis å»¶æ—¶é˜Ÿåˆ—å…œåº•ä»»åŠ¡

### 1. ä½¿ç”¨å»¶æ—¶é˜Ÿåˆ—å…œåº•

==**ä»»åŠ¡æŠ•é€’åˆ°çº¿ç¨‹æ± åï¼Œç´§æ¥ç€æˆ‘ä»¬å‘å»¶æ—¶é˜Ÿåˆ—ä¹ŸæŠ•é€’ä¸ªä»»åŠ¡ï¼Œå»¶è¿Ÿæ—¶é—´è®¾ç½®ä¸º 20 ç§’**==ã€‚ä¸ºä»€ä¹ˆå»¶è¿Ÿæ—¶é—´è®¾ç½® 20 ç§’ï¼ŒåŸå› æ˜¯æˆ‘ä»¬ç¬ƒå®šä¸Šé¢çº¿ç¨‹æ±  20 ç§’ä¹‹å†…å°±èƒ½ç»“æŸä»»åŠ¡ã€‚

```java
@Service
@RequiredArgsConstructor
public class CouponTaskServiceImpl extends ServiceImpl<CouponTaskMapper, CouponTaskDO> implements CouponTaskService {

    private final RedissonClient redissonClient;

    private final ExecutorService executorService = new ThreadPoolExecutor(
            Runtime.getRuntime().availableProcessors(),
            Runtime.getRuntime().availableProcessors() << 1,
            60,
            TimeUnit.SECONDS,
            new SynchronousQueue<>(),
            new ThreadPoolExecutor.DiscardPolicy()
    );
  
    @Transactional(rollbackFor = Exception.class)
    @Override
    public void createCouponTask(CouponTaskCreateReqDTO requestParam) {
        // éªŒè¯éç©ºå‚æ•°
        // éªŒè¯å‚æ•°æ˜¯å¦æ­£ç¡®ï¼Œæ¯”å¦‚æ–‡ä»¶åœ°å€æ˜¯å¦ä¸ºæˆ‘ä»¬æœŸæœ›çš„æ ¼å¼ç­‰
        // éªŒè¯å‚æ•°ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚é€‰æ‹©å®šæ—¶å‘é€ï¼Œå‘é€æ—¶é—´æ˜¯å¦ä¸ä¸ºç©ºç­‰
        CouponTemplateQueryRespDTO couponTemplate = couponTemplateService.findCouponTemplateById(requestParam.getCouponTemplateId());
        if (couponTemplate == null) {
            throw new ClientException("ä¼˜æƒ åˆ¸æ¨¡æ¿ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥æäº¤ä¿¡æ¯æ˜¯å¦æ­£ç¡®");
        }
        // ......

        // æ„å»ºä¼˜æƒ åˆ¸æ¨é€ä»»åŠ¡æ•°æ®åº“æŒä¹…å±‚å®ä½“
        CouponTaskDO couponTaskDO = BeanUtil.copyProperties(requestParam, CouponTaskDO.class);
        couponTaskDO.setBatchId(IdUtil.getSnowflakeNextId());
        couponTaskDO.setOperatorId(Long.parseLong(UserContext.getUserId()));
        couponTaskDO.setShopNumber(UserContext.getShopNumber());
        couponTaskDO.setStatus(
                Objects.equals(requestParam.getSendType(), CouponTaskSendTypeEnum.IMMEDIATE.getType())
                        ? CouponTaskStatusEnum.IN_PROGRESS.getStatus()
                        : CouponTaskStatusEnum.PENDING.getStatus()
        );

        // ä¿å­˜ä¼˜æƒ åˆ¸æ¨é€ä»»åŠ¡è®°å½•åˆ°æ•°æ®åº“
        couponTaskMapper.insert(couponTaskDO);

        // ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿè®¡è¡Œæ•°ï¼Ÿå› ä¸ºå‘é€åéœ€è¦æ¯”å¯¹æ‰€æœ‰ä¼˜æƒ åˆ¸æ˜¯å¦éƒ½å·²å‘æ”¾åˆ°ç”¨æˆ·è´¦å·
        // 100 ä¸‡æ•°æ®å¤§æ¦‚éœ€è¦ 4 ç§’æ‰èƒ½è¿”å›å‰ç«¯ï¼Œå¦‚æœåŠ ä¸ŠéªŒè¯å°†ä¼šæ—¶é—´æ›´é•¿ï¼Œæ‰€ä»¥è¿™é‡Œå°†æœ€è€—æ—¶çš„ç»Ÿè®¡æ“ä½œå¼‚æ­¥åŒ–
        JSONObject delayJsonObject = JSONObject
                .of("fileAddress", requestParam.getFileAddress(), "couponTaskId", couponTaskDO.getId());
        executorService.execute(() -> refreshCouponTaskSendNum(delayJsonObject));
      
        // å‡è®¾åˆšæŠŠä»»åŠ¡æäº¤åˆ°çº¿ç¨‹æ± ï¼Œçªç„¶åº”ç”¨å®•æœºäº†ï¼Œæˆ‘ä»¬é€šè¿‡å»¶è¿Ÿé˜Ÿåˆ—è¿›è¡Œå…œåº• Refresh
        RBlockingDeque<Object> blockingDeque = redissonClient.getBlockingDeque("COUPON_TASK_SEND_NUM_DELAY_QUEUE");
        RDelayedQueue<Object> delayedQueue = redissonClient.getDelayedQueue(blockingDeque);
        // è¿™é‡Œå»¶è¿Ÿæ—¶é—´è®¾ç½® 20 ç§’ï¼ŒåŸå› æ˜¯æˆ‘ä»¬ç¬ƒå®šä¸Šé¢çº¿ç¨‹æ±  20 ç§’ä¹‹å†…å°±èƒ½ç»“æŸä»»åŠ¡
        delayedQueue.offer(delayJsonObject, 20, TimeUnit.SECONDS);
    }
}
```

### 2. å®šä¹‰å»¶æ—¶é˜Ÿåˆ—æ¶ˆè´¹è€…

ä»£ç é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œ ä¸ºäº†é¿å…å¤æ‚ç›´æ¥å®šä¹‰ä¸€ä¸ª**å†…éƒ¨ç±»ï¼Œå®ç° `CommandLineRunner` æ¥å£åœ¨é¡¹ç›®å¯åŠ¨åè¿è¡Œåç½®ä»»åŠ¡**ã€‚æµç¨‹å¦‚ä¸‹ï¼š

1. ==å½“ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œä¸€ä¸ªçº¿ç¨‹ï¼Œæ— é™å¾ªç¯è·å– Redis é˜»å¡é˜Ÿåˆ—ä¸­å·²ç»åˆ°è¾¾æ—¶é—´çš„ä»»åŠ¡ï¼›==
2. ==ç„¶ååˆ¤æ–­æ•°æ®åº“ä¸­çš„åˆ†å‘ä»»åŠ¡ Excel æ€»æ•°æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºè¯»å– Excel è®°å½•ï¼ˆ refreshCouponTaskSendNumæ–¹æ³•ï¼‰ï¼Œç„¶åè®¾ç½®ï¼›å¦‚æœä¸ä¸ºç©ºè¯æ˜çº¿ç¨‹æ± å·²ç»è¿è¡Œå®Œäº†ã€‚==

```java
@Service
@RequiredArgsConstructor
public class CouponTaskServiceImpl extends ServiceImpl<CouponTaskMapper, CouponTaskDO> implements CouponTaskService {

     /**
     * ä¼˜æƒ åˆ¸å»¶è¿Ÿåˆ·æ–°å‘é€æ¡æ•°å…œåº•æ¶ˆè´¹è€…ï½œè¿™æ˜¯å…œåº•ç­–ç•¥ï¼Œä¸€èˆ¬æ¥è¯´ä¸ä¼šæ‰§è¡Œè¿™æ®µé€»è¾‘
     * å¦‚æœå»¶è¿Ÿæ¶ˆæ¯æ²¡æœ‰æŒä¹…åŒ–æˆåŠŸï¼Œæˆ–è€… Redis æŒ‚äº†æ€ä¹ˆåŠï¼Ÿåç»­å¯ä»¥äººå·¥å¤„ç†
     * <p>
     */
    @Service
    @RequiredArgsConstructor
    class RefreshCouponTaskDelayQueueRunner implements CommandLineRunner {

        private final CouponTaskMapper couponTaskMapper;
        private final RedissonClient redissonClient;

        @Override
        public void run(String... args) throws Exception {
            Executors.newSingleThreadExecutor(
                            runnable -> {
                                Thread thread = new Thread(runnable);
                                thread.setName("delay_coupon-task_send-num_consumer");
                                thread.setDaemon(Boolean.TRUE);
                                return thread;
                            })
                    .execute(() -> {
                        RBlockingDeque<JSONObject> blockingDeque = redissonClient.getBlockingDeque("COUPON_TASK_SEND_NUM_DELAY_QUEUE");
                        for (; ; ) {
                            try {
                                // è·å–å»¶è¿Ÿé˜Ÿåˆ—å·²åˆ°è¾¾æ—¶é—´ä»»åŠ¡
                                JSONObject delayJsonObject = blockingDeque.take();
                                if (delayJsonObject != null) {
                                    // è·å–ä¼˜æƒ åˆ¸æ¨é€è®°å½•ï¼ŒæŸ¥çœ‹å‘é€æ¡æ•°æ˜¯å¦å·²ç»æœ‰å€¼ï¼Œæœ‰çš„è¯ä»£è¡¨ä¸Šé¢çº¿ç¨‹æ± å·²ç»å¤„ç†å®Œæˆï¼Œæ— éœ€å†å¤„ç†
                                    CouponTaskDO couponTaskDO = couponTaskMapper.selectById(delayJsonObject.getLong("couponTaskId"));
                                    if (couponTaskDO.getSendNum() == null) {
                                        refreshCouponTaskSendNum(delayJsonObject);
                                    }
                                }
                            } catch (Throwable ignored) {
                            }
                        }
                    });
        }
    }
} 
```

### 3. èƒ½ä¸èƒ½ç›´æ¥ç”¨ Redis æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ

å¤§å®¶ä¸€å®šè¦è®°å¾—ï¼ŒRedis æ˜¯ä¸ªç¼“å­˜ï¼Œç”±äºå®ƒçš„**æŒä¹…åŒ–æœºåˆ¶å’Œä¸»ä»åŒæ­¥æœºåˆ¶**ï¼Œæ„å‘³ç€å¯èƒ½ä¼šä¸¢æ•°æ®ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬åªæ˜¯æŠŠå®ƒä½œä¸ºä¸€ä¸ªå…œåº•æ–¹æ¡ˆï¼Œè€Œä¸æ˜¯å…¨éƒ¨æ–¹æ¡ˆã€‚

- ==æŒä¹…åŒ–ä¸¢æ•°æ®æ˜¯å› ä¸ºå³ä½¿ AOF æŒä¹…åŒ–ä¹Ÿæ˜¯å¼‚æ­¥çš„ï¼Œæœ€å¥½çš„æƒ…å†µä¹Ÿä¼šä¸¢ä¸€æ¡æ•°æ®ã€‚==
- ==ä¸»ä»åŒæ­¥æœºåˆ¶ï¼Œå¦‚æœä¸»èŠ‚ç‚¹åœ¨æŸäº›å†™æ“ä½œå°šæœªåŒæ­¥åˆ°ä»èŠ‚ç‚¹æ—¶å‘ç”Ÿæ•…éšœï¼Œè¿™äº›æœªåŒæ­¥çš„å†™æ“ä½œå°†ä¼šä¸¢å¤±ã€‚==

## æ·»åŠ  Spring äº‹åŠ¡

ç»†å¿ƒçš„åŒå­¦å¯èƒ½çœ‹åˆ°æˆ‘ä»¬åœ¨æ–¹æ³•ä¸ŠåŠ äº†ä¸ª `@Transactional(rollbackFor = Exception.class)` æ³¨è§£ï¼Œ==è¿™æ˜¯å› ä¸ºå¦‚æœä¸åŠ æ³¨è§£çš„è¯ï¼Œæˆ‘ä»¬æ‰§è¡Œæ•°æ®åº“æ’å…¥æ“ä½œæˆåŠŸäº†ï¼Œä½†æ˜¯çº¿ç¨‹æ± å’Œå»¶æ—¶é˜Ÿåˆ—éƒ½æ²¡æœ‰æ‰§è¡Œã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå‘é€ä¸€æ¡æ•°æ®å°±æ°¸è¿œä¸ä¼šè¢«åˆ·æ–°ã€‚==

æˆ‘ä»¬å°±å°†æ•°æ®åº“çš„æ·»åŠ å’Œè¿™äº›è¡Œä¸ºç»‘å®šä¸€èµ·ï¼Œä¹Ÿå°±ä¸ä¼šå‡ºç°è¿™ç§é—®é¢˜äº†ã€‚

```java
@Service
@RequiredArgsConstructor
public class CouponTaskServiceImpl extends ServiceImpl<CouponTaskMapper, CouponTaskDO> implements CouponTaskService {

    @Transactional(rollbackFor = Exception.class)
    @Override
    public void createCouponTask(CouponTaskCreateReqDTO requestParam) {
        // ......
    }
}
```

## æ–‡æœ«æ€»ç»“

é€šè¿‡æœ¬ç¯‡æ–‡ç« è®©å¤§å®¶çŸ¥é“çº¿ç¨‹æ± çš„ä¸ç¡®å®šæ€§ï¼Œä»¥åŠå¦‚ä½•è§£å†³ã€‚ç®€å•ä¸€å¥è¯ï¼šå…ˆæ‰§è¡Œå†å»¶è¿Ÿç¡®è®¤ã€‚

å®Œç»“ï¼Œæ’’èŠ± ğŸ‰
